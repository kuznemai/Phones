import {defineStore} from "pinia";
import {reactive, ref} from "vue";

export const createdCartStore = defineStore('cartStore', {
    state: () => ({
        products: reactive({}),
        cart: reactive({}),
        counter: ref(0)
    }),
    actions: {
        addProduct(product) {
            this.products[product.id] = product;
        },

        addItemToCart(id, quantity) {
            if (!this.cart[id]) {
                this.cart[id] = 0
            }

            this.cart[id] += quantity

            if (this.cart[id] <= 0) {
                delete this.cart[id]
            }
        },
        // removeItemFromCart(item) {
        //     this.cart.splice(this.cart.indexOf(item), 1);
        //
        // },

        // modifyAmount(itemId, amount) {
        //     const item = this.cart.find(product => product.id === itemId)
        //     item.quantity += amount
        //
        //     if (item.quantity <= 0) {
        //         this.cart.splice(this.cart.indexOf(item), 1);
        //     }
        //
        // },
        getters: {
            getAllItems(state) {
                return [...state.cart]; // Возвращаем копию массива cart
            },
            getTotalValue(state) {
                return  Object.values(state.cart).reduce((total, id) => {
                    return total + state.products[id].price  item.price * item.quantity; // Суммируем цены всех элементов
                }, 0); // Начальное значение total равно 0
            },

            getCount(itemId) {
                return this.cart[itemId]
            }
        }


    },
});